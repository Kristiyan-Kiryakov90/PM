<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard - TaskFlow</title>
  <link rel="stylesheet" href="../src/css/global.css">
  <link rel="stylesheet" href="../src/css/dashboard.css">
</head>
<body>
  <!-- Navigation (injected by navbar component) -->

  <!-- Main Content -->
  <main class="dashboard-main">
    <div class="container py-6">
      <!-- Header -->
      <div class="dashboard-header mb-8">
        <div class="row">
          <div class="col-lg-8">
            <h1 class="mb-2">Dashboard</h1>
            <p class="text-muted">Welcome back! Here's an overview of your work.</p>
          </div>
        </div>
      </div>

      <!-- Stats Grid -->
      <div class="row g-4 mb-8">
        <div class="col-md-3">
          <div class="card">
            <div class="card-body">
              <div class="stats-label">Total Projects</div>
              <div class="stats-number" id="totalProjects">0</div>
              <div class="stats-trend text-success small">View all</div>
            </div>
          </div>
        </div>

        <div class="col-md-3">
          <div class="card">
            <div class="card-body">
              <div class="stats-label">Active Tasks</div>
              <div class="stats-number" id="activeTasks">0</div>
              <div class="stats-trend text-primary small">In progress</div>
            </div>
          </div>
        </div>

        <div class="col-md-3">
          <div class="card">
            <div class="card-body">
              <div class="stats-label">Completed This Week</div>
              <div class="stats-number" id="completedThisWeek">0</div>
              <div class="stats-trend text-success small">On track</div>
            </div>
          </div>
        </div>

        <div class="col-md-3">
          <div class="card">
            <div class="card-body">
              <div class="stats-label">Team Members</div>
              <div class="stats-number" id="teamMembers">0</div>
              <div class="stats-trend text-info small">In company</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Recent Activity Section -->
      <div class="row">
        <div class="col-lg-8">
          <div class="card">
            <div class="card-header">
              <h3 class="card-title mb-0">Recent Tasks</h3>
            </div>
            <div class="card-body" id="recentTasksContainer">
              <p class="text-muted text-center">No recent tasks. Create one to get started!</p>
            </div>
          </div>
        </div>

        <div class="col-lg-4">
          <div class="card">
            <div class="card-header">
              <h3 class="card-title mb-0">Quick Actions</h3>
            </div>
            <div class="card-body space-y-2">
              <a href="/public/projects.html" class="btn btn-primary w-100">
                <span>➕</span>
                <span>New Project</span>
              </a>
              <a href="/public/tasks.html" class="btn btn-outline-primary w-100">
                <span>✓</span>
                <span>Create Task</span>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <script type="module">
    import { renderNavbar } from '../src/js/components/navbar.js';
    import { requireAuth } from '../src/js/utils/router.js';
    import { getUserMetadata } from '../src/js/utils/auth.js';
    import { showError } from '../src/js/utils/ui-helpers.js';

    async function init() {
      try {
        // Ensure user is authenticated
        await requireAuth();

        // Render navbar
        await renderNavbar();

        // Load dashboard data
        const metadata = await getUserMetadata();
        console.log('User metadata:', metadata);

        // TODO: Load actual data from API in Plan 09
        // For now, display placeholder stats
        document.getElementById('totalProjects').textContent = '0';
        document.getElementById('activeTasks').textContent = '0';
        document.getElementById('completedThisWeek').textContent = '0';
        document.getElementById('teamMembers').textContent = '0';
      } catch (error) {
        console.error('Dashboard initialization error:', error);
        showError('Failed to load dashboard. Please refresh the page.');
      }
    }

    init();
  </script>
</body>
</html>
